<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Å∂„Å©„ÅÜ„Ç≠„É£„ÉÉ„ÉÅ„Ç≤„Éº„É†</title>
    <style>
        /* CSS„ÅØÂ§âÊõ¥„Å™„Åó */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%);
            overflow: hidden;
            touch-action: none;
            user-select: none;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
        }

        #girlCanvas { /* #girl „Åã„Çâ #girlCanvas „Å´Â§âÊõ¥ */
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 160px;
            z-index: 10;
            transition: left 0.1s ease;
        }

        .jumping {
            bottom: 150px !important;
        }

        .grape {
            position: absolute;
            width: 80px;
            height: 80px;
            z-index: 5;
            animation: fall linear;
        }

        .juice-drop {
            position: absolute;
            width: 60px;
            height: 80px;
            z-index: 5;
            animation: fall linear;
        }

        @keyframes fall {
            from {
                top: -80px;
            }
            to {
                top: 100vh;
            }
        }

        #juice {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 100px;
            height: 120px;
            z-index: 15;
        }

        #ui {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            font-size: 24px;
            font-weight: bold;
            z-index: 20;
        }

        #healthBar {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 30px;
            background: rgba(255,255,255,0.3);
            border: 3px solid white;
            border-radius: 15px;
            overflow: hidden;
            z-index: 20;
        }

        #healthFill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #ffa500, #32cd32);
            border-radius: 12px;
            transition: width 0.3s ease;
            width: 100%;
        }

        #grapeCounter {
            position: absolute;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 20;
        }

        .floating-text {
            position: absolute;
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
            z-index: 25;
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        #startScreen h1 {
            color: white;
            font-size: 48px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            margin-bottom: 30px;
        }

        #startButton {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
            transition: transform 0.2s;
        }

        #startButton:hover {
            transform: scale(1.1);
        }

        .cloud {
            position: absolute;
            background: white;
            border-radius: 50px;
            opacity: 0.8;
            animation: drift 20s linear infinite;
        }

        .cloud:before {
            content: '';
            position: absolute;
            background: white;
            border-radius: 50px;
        }

        .cloud1 {
            width: 100px;
            height: 40px;
            top: 20%;
            animation-duration: 25s;
        }

        .cloud1:before {
            width: 50px;
            height: 40px;
            top: -20px;
            left: 10px;
        }

        .cloud2 {
            width: 80px;
            height: 30px;
            top: 40%;
            animation-duration: 30s;
            animation-delay: -10s;
        }

        .cloud2:before {
            width: 40px;
            height: 30px;
            top: -15px;
            left: 15px;
        }

        @keyframes drift {
            from {
                left: -120px;
            }
            to {
                left: 100vw;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <div class="cloud cloud1"></div>
        <div class="cloud cloud2"></div>

        <div id="startScreen">
            <h1>üçá „Å∂„Å©„ÅÜ„Ç≠„É£„ÉÉ„ÉÅ„Ç≤„Éº„É† üçá</h1>
            <p style="color: white; font-size: 20px; margin-bottom: 30px; text-align: center; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">
                „Å∂„Å©„ÅÜ„Çí11ÂÄã„ÅÇ„Å§„ÇÅ„Å¶<br>„Ç∏„É•„Éº„Çπ„ÇíÈ£≤„ÇÇ„ÅÜÔºÅ
            </p>
            <button id="startButton" onclick="startGame()">„Ç≤„Éº„É†„Çπ„Çø„Éº„ÉàÔºÅ</button>
        </div>

        <canvas id="juiceCanvas" width="100" height="120" style="position: absolute; top: 20px; left: 20px; z-index: 15;"></canvas>
        
        <div id="ui">
            <div>„Çπ„Ç≥„Ç¢: <span id="score">0</span></div>
        </div>

        <div id="healthBar">
            <div id="healthFill"></div>
        </div>

        <div id="grapeCounter">
            „Å∂„Å©„ÅÜ: <span id="grapeCount">0</span> / 11
        </div>

        <canvas id="girlCanvas" width="120" height="160"></canvas>
    </div>

    <script>
        let gameState = {
            isPlaying: false,
            score: 0,
            health: 100,
            grapeCount: 0,
            girlX: window.innerWidth / 2,
            grapes: [],
            grapeSpeed: 2,
            spawnRate: 0.02
        };

        // „Ç≠„É£„É≥„Éê„ÇπË®≠ÂÆö
        const girlCanvas = document.getElementById('girlCanvas');
        const girlCtx = girlCanvas.getContext('2d');
        const juiceCanvas = document.getElementById('juiceCanvas');
        const juiceCtx = juiceCanvas.getContext('2d');

        // ‚ñº‚ñº‚ñº „ÄêÂ§âÊõ¥ÁÇπ2„ÄëÂ•≥„ÅÆÂ≠ê„ÅÆÁîªÂÉè„ÇíË™≠„ÅøËæº„ÇÄÂá¶ÁêÜ„ÇíËøΩÂä† ‚ñº‚ñº‚ñº
        const girlImage = new Image();
        girlImage.src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2gAAAOYCAYAAADCI0g7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAFlTSURBVHhe7d15mB1Vnf/x3ySgqAAiKCIi7rgLutZdd119r7v21LqudXXvu+4yqGsiLrjuiAgqKCCIiCSIBPK9P7MzmUmSmSSZyT0/n/d5v/mSM0/uSSbJvGfmvM+5DMMwRERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERER-9V0f/8u0sWqF6O//j2/M/vT2lW+Vv929vX+5/u/f0P/6O6y/MvvP9z+Xv4H/e/4v/T++7v/wP/796t//H/x49/+yP//yD93+s7/v///n3/7P/9H/9//vP97/+3f//8u/v/vH//v+1/9v/gLwT6h///m//w/+f+3v+1+9f/nf+f/L//mH7v+8/5d//e+Xv/uP//9lH9iL/+6ff/8v8P/2v/8H+P9r/9/+A/7/+z/+L/z/+1//P9//s//4H0j+f/m3P/i/4v/b/+D//3+/+l//Y8m/eN8F/+5/8+D/6P93/f+w9z//F9q/v/67f/0/+r/7/w38e/v/6v+9/j/+BwP/sP/mP1i+f/7P+L/7/1/zPwD2H/wP+n9y/v/L9n/zHyj/Qf1/6P+7n/9p/qP5H/X/s//s/z/i/6//n/7/Bv8n//8a+L/9/+q/v//X/9r+73D+b6H/d//+9P/n/8P/l//r9n9xP5z8X/k/8v/s/4T/1f/n/zf/p/8v/xf+/wP/X/4H/D/3//l"
        
        let isGirlImageLoaded = false;
        girlImage.onload = () => {
            isGirlImage-loaded = true;
            drawGirl(); // ÁîªÂÉèË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÊôÇ„Å´ÂàùÂõûÊèèÁîª
        };

        // ‚ñº‚ñº‚ñº „ÄêÂ§âÊõ¥ÁÇπ3„ÄëÂ•≥„ÅÆÂ≠ê„ÇíÊèèÁîª„Åô„ÇãÈñ¢Êï∞„ÇíÁîªÂÉèÊèèÁîª„Å´Â§âÊõ¥ ‚ñº‚ñº‚ñº
        function drawGirl() {
            girlCtx.clearRect(0, 0, girlCanvas.width, girlCanvas.height);
            if (isGirlImageLoaded) {
                // ÁîªÂÉè„Çícanvas„Å´ÊèèÁîª„Åó„Åæ„Åô
                girlCtx.drawImage(girlImage, 0, 0, girlCanvas.width, girlCanvas.height);
            }
        }
        
        function drawJuice() {
            juiceCtx.clearRect(0, 0, 100, 120);
            
            // „Ç∞„É©„Çπ
            juiceCtx.strokeStyle = 'black';
            juiceCtx.lineWidth = 3;
            juiceCtx.beginPath();
            juiceCtx.roundRect(20, 20, 60, 80, 5);
            juiceCtx.stroke();
            
            // „Ç∏„É•„Éº„Çπ
            const fillHeight = Math.min(70, (gameState.grapeCount / 11) * 70);
            if (fillHeight > 0) {
                juiceCtx.fillStyle = '#8A2BE2';
                juiceCtx.beginPath();
                juiceCtx.roundRect(23, 97 - fillHeight, 54, fillHeight, 3);
                juiceCtx.fill();
                
                // Ê≥°
                if (fillHeight > 10) {
                    juiceCtx.fillStyle = 'rgba(255,255,255,0.7)';
                    for (let i = 0; i < 5; i++) {
                        const x = 30 + Math.random() * 40;
                        const y = 90 - fillHeight + Math.random() * (fillHeight - 10);
                        juiceCtx.beginPath();
                        juiceCtx.arc(x, y, 2, 0, Math.PI * 2);
                        juiceCtx.fill();
                    }
                }
            }
        }

        function createGrape() {
            const grape = document.createElement('div');
            grape.className = 'grape';
            grape.style.left = Math.random() * (window.innerWidth - 80) + 'px';
            grape.style.animationDuration = (3 + Math.random() * 2) + 's';
            
            // „Å∂„Å©„ÅÜ„ÇíÊèèÁîª
            const canvas = document.createElement('canvas');
            canvas.width = 80;
            canvas.height = 80;
            const ctx = canvas.getContext('2d');
            
            // „Å∂„Å©„ÅÜ„ÅÆÊàø
            ctx.fillStyle = '#8A2BE2';
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 4 - i; j++) {
                    ctx.beginPath();
                    ctx.arc(20 + j * 15 + i * 7, 25 + i * 12, 8, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            // Ëåé
            ctx.strokeStyle = '#228B22';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(40, 10);
            ctx.lineTo(40, 25);
            ctx.stroke();
            
            grape.appendChild(canvas);
            document.getElementById('gameContainer').appendChild(grape);
            
            // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÁµÇ‰∫ÜÊôÇ„ÅÆÂá¶ÁêÜ
            grape.addEventListener('animationend', () => {
                if (grape.parentNode) { // Êó¢„Å´„Ç≠„É£„ÉÉ„ÉÅ„Åï„Çå„Å¶„ÅÑ„Å™„Åë„Çå„Å∞
                    grape.remove();
                    gameState.health -= 5;
                    updateHealth();
                }
            });
            
            return grape;
        }

        function checkCollision(grape) {
            const grapeRect = grape.getBoundingClientRect();
            const girlRect = girlCanvas.getBoundingClientRect();
            
            return (grapeRect.left < girlRect.right &&
                    grapeRect.right > girlRect.left &&
                    grapeRect.top < girlRect.bottom &&
                    grapeRect.bottom > girlRect.top);
        }

        function catchGrape(grape) {
            grape.remove();
            gameState.grapeCount++;
            gameState.score += 10;
            
            // „Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞„ÉÜ„Ç≠„Çπ„Éà
            showFloatingText('+10', gameState.girlX, window.innerHeight - 100);
            
            updateUI();
            
            if (gameState.grapeCount >= 11) {
                drinkJuice();
            }
        }

        function drinkJuice() {
            gameState.health = Math.min(100, gameState.health + 30);
            gameState.grapeCount = 0;
            gameState.score += 50;
            
            showFloatingText('„Ç∏„É•„Éº„ÇπÂÆåÊàêÔºÅ +50', gameState.girlX, window.innerHeight - 150);
            updateUI();
            updateHealth();
        }

        function showFloatingText(text, x, y) {
            const element = document.createElement('div');
            element.className = 'floating-text';
            element.textContent = text;
            element.style.left = x + 'px';
            element.style.top = y + 'px';
            document.getElementById('gameContainer').appendChild(element);
            
            setTimeout(() => element.remove(), 1000);
        }

        function updateUI() {
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('grapeCount').textContent = gameState.grapeCount;
            drawJuice();
        }

        function updateHealth() {
            const healthPercent = Math.max(0, gameState.health / 100 * 100);
            document.getElementById('healthFill').style.width = healthPercent + '%';
            
            if (gameState.health <= 0) {
                gameOver();
            }
        }

        function gameOver() {
            gameState.isPlaying = false;
            alert(`„Ç≤„Éº„É†„Ç™„Éº„Éê„ÉºÔºÅ\n„Çπ„Ç≥„Ç¢: ${gameState.score}`);
            location.reload();
        }

        function startGame() {
            // ‚ñº‚ñº‚ñº „ÄêÂ§âÊõ¥ÁÇπ4„ÄëÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø„ÅåÂÆå‰∫Ü„Åó„Å¶„Åã„Çâ„Ç≤„Éº„É†„ÇíÈñãÂßã„Åô„Çã ‚ñº‚ñº‚ñº
            if (!isGirlImageLoaded) {
                alert("ÁîªÂÉè„ÅÆË™≠„ÅøËæº„Åø‰∏≠„Åß„Åô„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„Çπ„Çø„Éº„Éà„Éú„Çø„É≥„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ");
                return;
            }
            document.getElementById('startScreen').style.display = 'none';
            gameState.isPlaying = true;
            drawJuice();
            gameLoop();
        }

        function gameLoop() {
            if (!gameState.isPlaying) return;
            
            // „Å∂„Å©„ÅÜ„ÇíÁîüÊàê
            if (Math.random() < gameState.spawnRate) {
                createGrape();
            }
            
            // Ë°ùÁ™ÅÂà§ÂÆö
            const grapes = document.querySelectorAll('.grape');
            grapes.forEach(grape => {
                if (checkCollision(grape)) {
                    catchGrape(grape);
                }
            });
            
            // ÊôÇÈñìÁµåÈÅé„Åß„Éò„É´„Çπ„ÅåÊ∏õÂ∞ë
            if (Math.random() < 0.01) {
                gameState.health -= 1;
                updateHealth();
            }
            
            requestAnimationFrame(gameLoop);
        }

        // „Çø„ÉÉ„ÉÅ„Éª„Éû„Ç¶„ÇπÊìç‰Ωú
        function handleMove(clientX) {
            if (!gameState.isPlaying) return;
            
            const girlWidth = girlCanvas.width;
            gameState.girlX = Math.max(girlWidth / 2, Math.min(window.innerWidth - (girlWidth / 2), clientX));
            girlCanvas.style.left = gameState.girlX + 'px';
        }

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº
        document.addEventListener('mousemove', (e) => handleMove(e.clientX));
        document.addEventListener('touchmove', (e) => {
            e.preventDefault();
            handleMove(e.touches[0].clientX);
        }, { passive: false });

        // ÂàùÊúüÂåñ
        updateUI();
        updateHealth();
    </script>
</body>
</html>
